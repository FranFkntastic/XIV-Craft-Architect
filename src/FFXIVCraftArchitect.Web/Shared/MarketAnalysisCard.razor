@using FFXIVCraftArchitect.Core.Models

<div style="background: @(IsSelected ? "#3a3a30" : "#2a2a25"); border-radius: 4px; border: 2px solid @(IsSelected ? "#d4a73a" : "#444"); overflow: hidden; transition: background 0.15s ease;">
    <!-- Compact Header (always visible when collapsed) -->
    <div style="display: flex; align-items: center; padding: 6px 10px; background: @(IsSelected ? "#4a4a40" : "#363630");">
        
        <!-- Selection Indicator -->
        @if (IsSelected)
        {
            <MudIcon Icon="@Icons.Material.Filled.Visibility" 
                     Style="color: #d4a73a; margin-right: 6px;" 
                     Size="Size.Small" />
        }
        else
        {
            <MudIcon Icon="@Icons.Material.Filled.ChevronRight" 
                     Style="color: #888; margin-right: 6px;" 
                     Size="Size.Small" />
        }
        
        <!-- Item Name -->
        <div style="flex: 1; min-width: 0; overflow: hidden;">
            <MudText Typo="Typo.body2" Style="color: #fff; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                @Plan.Name
            </MudText>
        </div>
        
        <!-- Quantity -->
        <MudText Typo="Typo.caption" Style="color: #d4a73a; margin: 0 8px; min-width: 40px; text-align: right;">
            Ã—@(Plan.QuantityNeeded)
        </MudText>
        
        @if (Plan.RecommendedWorld != null)
        {
            <!-- Best World -->
            <div style="text-align: right; margin-right: 8px; min-width: 70px;">
                <MudText Typo="Typo.caption" Style="color: #90EE90; font-weight: 600;">
                    @Plan.RecommendedWorld.WorldName
                </MudText>
            </div>
            
            <!-- Price per unit -->
            <MudText Typo="Typo.caption" Style="color: #aaa; min-width: 60px; text-align: right; margin-right: 8px;">
                @Plan.RecommendedWorld.AveragePricePerUnit.ToString("N0")g
            </MudText>
            
            <!-- Total Cost -->
            <MudText Typo="Typo.body2" Style="color: #d4a73a; font-weight: 600; min-width: 70px; text-align: right;">
                @Plan.RecommendedWorld.TotalCost.ToString("N0")g
            </MudText>
        }
        else
        {
            <MudText Typo="Typo.caption" Style="color: #666; min-width: 70px; text-align: right;">
                No data
            </MudText>
        }
    </div>
</div>

@code {
    [Parameter]
    public DetailedShoppingPlan Plan { get; set; } = null!;
    
    [Parameter]
    public bool IsCollapsed { get; set; } = true;
    
    [Parameter]
    public bool IsSelected { get; set; } = false;
}
